# SpeedControlServo
Raspberry Pi PicoでVarSpeedServoを使おうとしたところ、タイマーの部分でコンパイルエラーになってしまったので作りました。随時、必要そうな関数を追加していきます。

digitalWrite()、millis()、micros()のみで構成しているのでタイマーを占有しません。その代わり、loopProcess()を常に実行し続ける必要があります。サンプルコードではマルチコアであるRP2040特有のコードになっています。シングルコアのマイコンで実行するときはloop()内で上手く実行するか、タイマーで実行してください。処理時間はRP2040で3.8us程度なのでタイマー内で実行しても問題ないかと思います。

## attach(pin_size_t pin, {int min, int max, int value});
サーボモータの初期設定をします。{}内の引数は省略可能です。
|引数|機能|
|-|-|
|pin|PWM出力をするピンのピン番号を指定します。|
|min|PWM信号のON時間の最小値を指定します。0°の位置がズレているときは指定してください。|
|max|PWM信号のON時間の最大値を指定します。180°の位置がズレているときは指定してください。|
|value|起動時の初期位置を指定します。引数を省略すると0が入ります。|

## write(int time_ms, int angle)
サーボモータを駆動させます。
|引数|機能|
|-|-|
|time_ms|動き始めてから目標位置に到達するまでの時間を指定します。単位はmsです。<br>サーボモータの最高速でも間に合わない時間を指定した場合は最高速で動きます。|
|angle|目標位置を指定します。|

## loopProcess()
動き始めてからの経過時間から現在の角度を計算します。経過時間はms単位で計算しているので、1msより短い周期で実行してください。1msより長い周期だと動きがカクカクすることがあります。